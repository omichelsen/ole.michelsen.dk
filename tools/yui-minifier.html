<?php 
$_PageTitle = "YUI Script Minifier";

if($_POST) 
{
	include('../includes/YUICompressor.php');	
	Minify_YUICompressor::$jarFile = '../includes/yuicompressor-2.4.6.jar';
	Minify_YUICompressor::$tempDir = '../cache';

	$input = stripslashes($_POST['input']);

	if ($_POST['datatype'] === 'css')
	{
		echo Minify_YUICompressor::minifyCss($input);
	}
	else
	{
		echo Minify_YUICompressor::minifyJs($input,array('nomunge' => false));
	}

	exit;
}
?>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />

	<title>Ole Michelsen | Tools: <?php echo $_PageTitle ?></title>
	
	<meta name="keywords" content="ole michelsen, ole bjÃ¸rn michelsen, web developer, programming, work, url, yui, compress, compression, minify, minifier, minifyer, yui compress, css, stylesheet, javascript, js, yahoo user interface group, ajax, obfuscate, obfuscation" />
	<meta name="description" content="Minify CSS and JavaScript using YUI Compressor by rewriting the code eliminating white-space and line breaks and obfuscating JavaScript variables." />
	
	<link rel="canonical" href="http://ole.michelsen.dk/tools/yui-minifier.html" />
	<link rel="index" href="http://ole.michelsen.dk/tools/" />

<?php include(getenv("DOCUMENT_ROOT")."/ole/templates/header.html"); ?>
</head>

<body itemscope itemtype="http://schema.org/WebPage">

<?php include(getenv("DOCUMENT_ROOT")."/ole/templates/topnav.html"); ?>

<div id="content">
	<section id="tools">

		<h1>Tools</h1>
	
		<h2><?php echo $_PageTitle ?></h2>
		
		<p>This web page compresses Style Sheets and JavaScripts, by rewriting the code to a more compact form. This is called <i>minifying</i>, and is based on safe renaming of variables within a defined scope (for JavaScript), and elimination of line-breaks and unneeded whitespace.</p>
		
		<p>I have described the <a href="../portfolio/site-optimization.html#minify">savings achieved</a> by this in a previous article, and it is a technique which quickly has become standard practice in recent years. Normally you would apply a minifier as a part of your build scripts, but for small sites and/or testing I have found it very useful to have a quick reference tool available.</p>
		
		<p>Just paste your CSS or JavaScript into the Input field, and select the appropriate type for compression:</p>

		<form id="minifier">
			<div class="column-left">
				<p>
				<label for="input"><b>Input:</b></label><br />
				<textarea autofocus="autofocus" class="text" id="input" name="input" style="width:440px;height:150px;font-size:smaller;" tabindex="1" required="required"></textarea>
				</p>
			</div>
				
			<div class="column-right">				
				<p>
				<label for="output"><b>Output:</b></label><br />
				<textarea class="text" id="output" name="output" style="width:440px;height:150px;font-size:smaller;" readonly="readonly" tabindex="4"></textarea>
				</p>
			</div>
			
			<p>
				<span class="floatright" id="resultstats"></span>
			
				<select id="datatype" name="datatype" tabindex="2">
					<option value="css">CSS</option>
					<option value="js">JavaScript</option>
				</select>
				
				&nbsp;&nbsp;&nbsp;
				<input class="button" type="submit" value="Compress" tabindex="3" />
				
				&nbsp;&nbsp;&nbsp;
				<img id="loader" style="display:none;" src="http://cdn.ole.michelsen.dk/images/ajax-loader.gif" alt="Loading..." height="11" width="16" />
			</p>
		</form>
	
		<aside style="color:#666">
			<br /><br /><time datetime="2011-07-05">Updated: Tuesday, July 5<sup>th</sup> 2011</time>
			<br />Changed my implementation of this tool, and the Microsoft AJAX Minifier is no longer supported. The old version can still be <a href="minifier.html">found here</a>.
		</aside>

	</section>
</div>

<?php include(getenv("DOCUMENT_ROOT")."/ole/templates/footer.html"); ?>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript">
<?php 

$DEBUG = false;

if ($DEBUG) { 
?>
$(document).ready(function() {
	$('#minifier').submit(function() {

		// Disable the submit button
		$('input[type=submit]').prop('disabled', true);

		// Display the loading animation
		$('#loader').toggle();
		
		// Serialize and post the form data to the proxy
		var formdata = $(this).serialize();
		$.post('yui-minifier.html'
			, formdata
			, function(data) {
				// Write result to output field
				$('#output').val(data).select();
				
				// Write stats
				var sizeInput = $('#input').val().length;
				var sizeOutput = data.length;
				var percent = Math.round((sizeOutput/sizeInput-1)*100);
				$('#resultstats').html('Reduced input size from '+sizeInput+' to '+sizeOutput+' ('+percent+'%)');
				
				// Enable the submit button
				$('input[type=submit]').prop('disabled', false);
				
				// Hide the loading animation
				$('#loader').toggle();
			}
		);
		return false;
	});
});
<?php } else { ?>
$(document).ready(function(){$("#minifier").submit(function(){$("input[type=submit]").prop("disabled",true);$("#loader").toggle();var a=$(this).serialize();$.post("yui-minifier.html",a,function(d){$("#output").val(d).select();var b=$("#input").val().length;var e=d.length;var c=Math.round((e/b-1)*100);$("#resultstats").html("Reduced input size from "+b+" to "+e+" ("+c+"%)");$("input[type=submit]").prop("disabled",false);$("#loader").toggle()});return false})});
<?php } ?>
</script>

</body>
</html>