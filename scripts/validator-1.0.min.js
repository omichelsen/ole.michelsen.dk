var activeTimers=0,timerIntervalId=0;$(document).ready(function(){$("#validator").submit(function(){$("input[type=submit]").prop("disabled",true);$("#results").html('<tr><td class="c" colspan="3">Processing sitemap...<br /><img src="http://cdn.ole.michelsen.dk/images/ajax-loader.gif" height="11" width="16" /></td></tr>');$.getJSON("validator-sitemap.php",{uri:$("#sitemapuri").val()},function(a){if(a.length>0){var c=2e3,b="";$.each(a,function(a,d){b+="<tr"+(a%2==1?' class="alt">':">")+'<td class="r">'+(a+1)+":</td><td>"+d+'</td><td class="c" id="loading'+a+'">'+(a<30?'<img src="http://cdn.ole.michelsen.dk/images/ajax-loader.gif" height="11" width="16" />':"Deferred")+"</td></tr>";if(a<30){setTimeout("validate("+a+", '"+d+"')",c*a);activeTimers++}});$("#results").html(b)}else{$("#results td:first").html('<span style="color:#B00">Sitemap could not be parsed - wrong URI?</span>');$("input[type=submit]").prop("disabled",false)}});return false})});function validate(b,a){$.getJSON("validator-proxy.php",{uri:a},function(c){$("#loading"+b).html('<a href="http://validator.w3.org/check?uri='+encodeURIComponent(a)+'" target="_blank" style="color:'+(c.valid=="Passed"?"#006400":"#B00")+'">'+(c.valid||c.error)+"</a>");activeTimers--;checkTimers()})}function checkTimers(){if(activeTimers<1){$("input[type=submit]").removeAttr("disabled");clearInterval(timerIntervalId)}}